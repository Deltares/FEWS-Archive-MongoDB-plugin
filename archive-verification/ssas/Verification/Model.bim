{
  "name": "Verification_QT_Hourly",
  "compatibilityLevel": 1600,
  "model": {
    "name": "Verification_QT_Hourly",
    "culture": "en-US",
    "dataSources": [
      {
        "type": "structured",
        "name": "dataSource",
        "maxConnections": 32,
        "connectionDetails": {
          "protocol": "odbc",
          "address": {
            "options": {
              "driver": "MongoDB ODBC 1.4.5 ANSI Driver",
              "server": "knxpwmongodb1.main.tva.gov",
              "port": "3309"
            }
          },
          "authentication": null,
          "query": null
        },
        "credential": {
          "AuthenticationKind": "UsernamePassword",
          "kind": "Odbc",
          "path": "driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309",
          "Username": "fews_admin",
          "Password": "AvjgHB1zgtBS*T#"
        }
      }
    ],
    "tables": [
      {
        "name": "Forecast",
        "columns": [
          {
            "name": "forecast",
            "dataType": "string",
            "sourceColumn": "forecast"
          },
          {
            "name": "forecastId",
            "dataType": "string",
            "sourceColumn": "forecastId"
          },
          {
            "name": "ensemble",
            "dataType": "string",
            "sourceColumn": "ensemble"
          },
          {
            "name": "ensembleMember",
            "dataType": "string",
            "sourceColumn": "ensembleMember"
          }
        ],
        "partitions": [
          {
            "name": "Forecast",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Forecast = Table.Sort(Table.Distinct(Odbc.Query(Source, \"",
                "        SELECT forecastId, forecast, ensemble, ensembleMember FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Forecast_Default` UNION ALL",
                "        SELECT forecastId, forecast, ensemble, ensembleMember FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Forecast_Default` UNION ALL",
                "        SELECT forecastId, forecast, ensemble, ensembleMember FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Forecast_Default` UNION ALL",
                "        SELECT forecastId, forecast, ensemble, ensembleMember FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Forecast_Default` UNION ALL",
                "        SELECT forecastId, forecast, ensemble, ensembleMember FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Forecast_Default` UNION ALL",
                "        SELECT forecastId, forecast, ensemble, ensembleMember FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Forecast_Default` UNION ALL",
                "        SELECT forecastId, forecast, ensemble, ensembleMember FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Forecast_Default` UNION ALL",
                "        SELECT 'Normal' AS forecastId, 'Normal' AS forecast, '' AS ensemble, '' AS ensembleMember;\")), {\"forecast\",\"ensemble\",\"ensembleMember\"})",
                "",
                "in",
                "    Forecast"
              ]
            }
          }
        ],
        "hierarchies": [
          {
            "name": "ForecastEnsemble",
            "levels": [
              {
                "name": "forecast",
                "ordinal": 0,
                "column": "forecast"
              },
              {
                "name": "ensemble",
                "ordinal": 1,
                "column": "ensemble"
              },
              {
                "name": "ensembleMember",
                "ordinal": 2,
                "column": "ensembleMember"
              }
            ]
          }
        ]
      },
      {
        "name": "ForecastClass",
        "columns": [
          {
            "name": "class",
            "dataType": "string",
            "sourceColumn": "class"
          }
        ],
        "partitions": [
          {
            "name": "ForecastClass",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Class = Table.Sort(Odbc.Query(Source, \"SELECT * FROM Verification.`QT_Hourly_Class`;\"), {\"class\"})",
                "",
                "in",
                "    Class"
              ]
            }
          }
        ]
      },
      {
        "name": "ObservedClass",
        "columns": [
          {
            "name": "class",
            "dataType": "string",
            "sourceColumn": "class"
          }
        ],
        "partitions": [
          {
            "name": "ObservedClass",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Class = Table.Sort(Odbc.Query(Source, \"SELECT * FROM Verification.`QT_Hourly_Class`;\"), {\"class\"})",
                "",
                "in",
                "    Class"
              ]
            }
          }
        ]
      },
      {
        "name": "ContingencyMatrixClass",
        "columns": [
          {
            "name": "class",
            "dataType": "string",
            "sourceColumn": "class"
          }
        ],
        "partitions": [
          {
            "name": "ContingencyMatrixClass",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Class = Table.Sort(Odbc.Query(Source, \"SELECT * FROM Verification.`QT_Hourly_Class`;\"), {\"class\"})",
                "",
                "in",
                "    Class"
              ]
            }
          }
        ]
      },
      {
        "name": "EventDate",
        "columns": [
          {
            "name": "date",
            "dataType": "dateTime",
            "sourceColumn": "date"
          },
          {
            "name": "day",
            "dataType": "string",
            "sourceColumn": "day"
          },
          {
            "name": "dayOfMonth",
            "dataType": "int64",
            "sourceColumn": "dayOfMonth"
          },
          {
            "name": "dayOfWeek",
            "dataType": "int64",
            "sourceColumn": "dayOfWeek"
          },
          {
            "name": "dayOfWeekName",
            "dataType": "string",
            "sourceColumn": "dayOfWeekName",
            "sortByColumn": "dayOfWeek"
          },
          {
            "name": "dayOfYear",
            "dataType": "int64",
            "sourceColumn": "dayOfYear"
          },
          {
            "name": "month",
            "dataType": "string",
            "sourceColumn": "month"
          },
          {
            "name": "monthDay",
            "dataType": "string",
            "sourceColumn": "monthDay"
          },
          {
            "name": "monthName",
            "dataType": "string",
            "sourceColumn": "monthName",
            "sortByColumn": "month"
          },
          {
            "name": "monthOfYear",
            "dataType": "int64",
            "sourceColumn": "monthOfYear"
          },
          {
            "name": "monthOfYearName",
            "dataType": "string",
            "sourceColumn": "monthOfYearName",
            "sortByColumn": "monthOfYear"
          },
          {
            "name": "year",
            "dataType": "int64",
            "sourceColumn": "year"
          },
          {
            "name": "weekOfYear",
            "dataType": "int64",
            "sourceColumn": "weekOfYear"
          },
          {
            "name": "metSeason",
            "dataType": "string",
            "sourceColumn": "metSeason",
            "sortByColumn": "monthOfYear"
          },
          {
            "name": "poolSeason",
            "dataType": "string",
            "sourceColumn": "poolSeason",
            "sortByColumn": "monthOfYear"
          }
        ],
        "partitions": [
          {
            "name": "EventDate",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    EventDate = Table.Sort(Table.Distinct(Odbc.Query(Source, \"",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_EventDate_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_EventDate_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_EventDate_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_EventDate_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_EventDate_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_EventDate_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_EventDate_Default`;\")), {\"date\"})",
                "",
                "in",
                "    EventDate"
              ]
            }
          }
        ],
        "hierarchies": [
          {
            "name": "calendarDate",
            "levels": [
              {
                "name": "year",
                "ordinal": 0,
                "column": "year"
              },
              {
                "name": "month",
                "ordinal": 1,
                "column": "monthName"
              },
              {
                "name": "date",
                "ordinal": 2,
                "column": "date"
              }
            ]
          }
        ]
      },
      {
        "name": "ForecastDate",
        "columns": [
          {
            "name": "date",
            "dataType": "dateTime",
            "sourceColumn": "date"
          },
          {
            "name": "day",
            "dataType": "string",
            "sourceColumn": "day"
          },
          {
            "name": "dayOfMonth",
            "dataType": "int64",
            "sourceColumn": "dayOfMonth"
          },
          {
            "name": "dayOfWeek",
            "dataType": "int64",
            "sourceColumn": "dayOfWeek"
          },
          {
            "name": "dayOfWeekName",
            "dataType": "string",
            "sourceColumn": "dayOfWeekName",
            "sortByColumn": "dayOfWeek"
          },
          {
            "name": "dayOfYear",
            "dataType": "int64",
            "sourceColumn": "dayOfYear"
          },
          {
            "name": "month",
            "dataType": "string",
            "sourceColumn": "month"
          },
          {
            "name": "monthDay",
            "dataType": "string",
            "sourceColumn": "monthDay"
          },
          {
            "name": "monthName",
            "dataType": "string",
            "sourceColumn": "monthName",
            "sortByColumn": "month"
          },
          {
            "name": "monthOfYear",
            "dataType": "int64",
            "sourceColumn": "monthOfYear"
          },
          {
            "name": "monthOfYearName",
            "dataType": "string",
            "sourceColumn": "monthOfYearName",
            "sortByColumn": "monthOfYear"
          },
          {
            "name": "weekOfYear",
            "dataType": "int64",
            "sourceColumn": "weekOfYear"
          },
          {
            "name": "year",
            "dataType": "int64",
            "sourceColumn": "year"
          },
          {
            "name": "metSeason",
            "dataType": "string",
            "sourceColumn": "metSeason",
            "sortByColumn": "monthOfYear"
          },
          {
            "name": "poolSeason",
            "dataType": "string",
            "sourceColumn": "poolSeason",
            "sortByColumn": "monthOfYear"
          }
        ],
        "partitions": [
          {
            "name": "ForecastDate",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    ForecastDate = Table.Sort(Table.Distinct(Odbc.Query(Source, \"",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_ForecastDate_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_ForecastDate_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_ForecastDate_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_ForecastDate_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_ForecastDate_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_ForecastDate_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_ForecastDate_Default`;\")), {\"date\"})",
                "",
                "in",
                "    ForecastDate"
              ]
            }
          }
        ],
        "hierarchies": [
          {
            "name": "calendarDate",
            "levels": [
              {
                "name": "year",
                "ordinal": 0,
                "column": "year"
              },
              {
                "name": "month",
                "ordinal": 1,
                "column": "monthName"
              },
              {
                "name": "date",
                "ordinal": 2,
                "column": "date"
              }
            ]
          }
        ]
      },
      {
        "name": "ForecastTime",
        "columns": [
          {
            "name": "hour",
            "dataType": "double",
            "sourceColumn": "hour"
          },
          {
            "name": "minute",
            "dataType": "int64",
            "sourceColumn": "minute"
          }
        ],
        "partitions": [
          {
            "name": "ForecastTime",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    ForecastTime = Table.Sort(Table.Distinct(Odbc.Query(Source, \"",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_ForecastTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_ForecastTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_ForecastTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_ForecastTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_ForecastTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_ForecastTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_ForecastTime_Default`;\")), {\"minute\"})",
                "",
                "in",
                "    ForecastTime"
              ]
            }
          }
        ]
      },
      {
        "name": "EventTime",
        "columns": [
          {
            "name": "hour",
            "dataType": "double",
            "sourceColumn": "hour"
          },
          {
            "name": "minute",
            "dataType": "int64",
            "sourceColumn": "minute"
          }
        ],
        "partitions": [
          {
            "name": "EventTime",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    EventTime = Table.Sort(Table.Distinct(Odbc.Query(Source, \"",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_EventTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_EventTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_EventTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_EventTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_EventTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_EventTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_EventTime_Default`;\")), {\"minute\"})",
                "",
                "in",
                "    EventTime"
              ]
            }
          }
        ]
      },
      {
        "name": "Location",
        "columns": [
          {
            "name": "location",
            "dataType": "string",
            "sourceColumn": "location"
          },
          {
            "name": "CHATT_ABOVE_BELOW",
            "dataType": "string",
            "sourceColumn": "CHATT_ABOVE_BELOW",
            "displayFolder": "Attributes"
          },
          {
            "name": "DESCRIPTION",
            "dataType": "string",
            "sourceColumn": "DESCRIPTION",
            "displayFolder": "Attributes"
          },
          {
            "name": "DRAINAGE_AREA",
            "dataType": "double",
            "sourceColumn": "DRAINAGE_AREA",
            "displayFolder": "Attributes"
          },
          {
            "name": "FCGROUP",
            "dataType": "string",
            "sourceColumn": "FCGROUP",
            "displayFolder": "Attributes"
          },
          {
            "name": "HECRAS_MODEL",
            "dataType": "string",
            "sourceColumn": "HECRAS_MODEL",
            "displayFolder": "Attributes"
          },
          {
            "name": "HYDRO_ORDER",
            "dataType": "double",
            "sourceColumn": "HYDRO_ORDER",
            "displayFolder": "Attributes"
          },
          {
            "name": "MIN_STORAGE_ACFT",
            "dataType": "double",
            "sourceColumn": "MIN_STORAGE_ACFT",
            "displayFolder": "Attributes"
          },
          {
            "name": "NUM_GEN_UNITS",
            "dataType": "double",
            "sourceColumn": "NUM_GEN_UNITS",
            "displayFolder": "Attributes"
          },
          {
            "name": "NWSID Long Name",
            "dataType": "string",
            "sourceColumn": "NWSID Long Name",
            "displayFolder": "Attributes"
          },
          {
            "name": "OWNER",
            "dataType": "string",
            "sourceColumn": "OWNER",
            "displayFolder": "Attributes"
          },
          {
            "name": "PLANTID",
            "dataType": "string",
            "sourceColumn": "PLANTID",
            "displayFolder": "Attributes"
          },
          {
            "name": "PLANT_TYPE",
            "dataType": "string",
            "sourceColumn": "PLANT_TYPE",
            "displayFolder": "Attributes"
          },
          {
            "name": "lat",
            "dataType": "double",
            "sourceColumn": "lat",
            "displayFolder": "Attributes"
          },
          {
            "name": "lon",
            "dataType": "double",
            "sourceColumn": "lon",
            "displayFolder": "Attributes"
          },
          {
            "name": "x",
            "dataType": "double",
            "sourceColumn": "x",
            "displayFolder": "Attributes"
          },
          {
            "name": "y",
            "dataType": "double",
            "sourceColumn": "y",
            "displayFolder": "Attributes"
          },
          {
            "name": "z",
            "dataType": "double",
            "sourceColumn": "z",
            "displayFolder": "Attributes"
          },
          {
            "name": "shortName",
            "dataType": "string",
            "sourceColumn": "shortName",
            "displayFolder": "Attributes"
          },
          {
            "name": "RIVER_NAME",
            "dataType": "string",
            "sourceColumn": "RIVER_NAME",
            "displayFolder": "Attributes"
          },
          {
            "name": "RIVER_MILE",
            "dataType": "double",
            "sourceColumn": "RIVER_MILE",
            "displayFolder": "Attributes"
          },
          {
            "name": "RWID",
            "dataType": "string",
            "sourceColumn": "RWID",
            "displayFolder": "Attributes"
          },
          {
            "name": "RSNO_MESSAGES",
            "dataType": "double",
            "sourceColumn": "RSNO_MESSAGES",
            "displayFolder": "Attributes"
          },
          {
            "name": "RW_NAME",
            "dataType": "string",
            "sourceColumn": "RW_NAME",
            "displayFolder": "Attributes"
          },
          {
            "name": "RW_PAR_NAME",
            "dataType": "string",
            "sourceColumn": "RW_PAR_NAME",
            "displayFolder": "Attributes"
          },
          {
            "name": "SPILL_NAME",
            "dataType": "string",
            "sourceColumn": "SPILL_NAME",
            "displayFolder": "Attributes"
          },
          {
            "name": "SPILL_ORDER",
            "dataType": "string",
            "sourceColumn": "SPILL_ORDER",
            "displayFolder": "Attributes"
          },
          {
            "name": "STEPSIZE",
            "dataType": "double",
            "sourceColumn": "STEPSIZE",
            "displayFolder": "Attributes"
          },
          {
            "name": "SUMMER_POOL_M",
            "dataType": "double",
            "sourceColumn": "SUMMER_POOL_M",
            "displayFolder": "Attributes"
          },
          {
            "name": "TIMEZONE_LOCAL",
            "dataType": "string",
            "sourceColumn": "TIMEZONE_LOCAL",
            "displayFolder": "Attributes"
          },
          {
            "name": "TOG_STORAGE_ACFT",
            "dataType": "double",
            "sourceColumn": "TOG_STORAGE_ACFT",
            "displayFolder": "Attributes"
          },
          {
            "name": "TVA_FCGROUP",
            "dataType": "string",
            "sourceColumn": "TVA_FCGROUP",
            "displayFolder": "Attributes"
          },
          {
            "name": "USGSID",
            "dataType": "double",
            "sourceColumn": "USGSID",
            "displayFolder": "Attributes"
          },
          {
            "name": "WV_NAME",
            "dataType": "string",
            "sourceColumn": "WV_NAME",
            "displayFolder": "Attributes"
          }
        ],
        "partitions": [
          {
            "name": "Location",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Location = Table.Sort(Table.RemoveColumns(Table.Distinct(Table.Sort(Odbc.Query(Source, \"",
                "        SELECT s.location, l.* FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Location_Default` s INNER JOIN Verification.`QT_Hourly_Location` l ON l.locationId=s.locationId UNION ALL",
                "        SELECT s.location, l.* FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Location_Default` s INNER JOIN Verification.`QT_Hourly_Location` l ON l.locationId=s.locationId UNION ALL",
                "        SELECT s.location, l.* FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Location_Default` s INNER JOIN Verification.`QT_Hourly_Location` l ON l.locationId=s.locationId UNION ALL",
                "        SELECT s.location, l.* FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Location_Default` s INNER JOIN Verification.`QT_Hourly_Location` l ON l.locationId=s.locationId UNION ALL",
                "        SELECT s.location, l.* FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Location_Default` s INNER JOIN Verification.`QT_Hourly_Location` l ON l.locationId=s.locationId UNION ALL",
                "        SELECT s.location, l.* FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Location_Default` s INNER JOIN Verification.`QT_Hourly_Location` l ON l.locationId=s.locationId UNION ALL",
                "        SELECT s.location, l.* FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Location_Default` s INNER JOIN Verification.`QT_Hourly_Location` l ON l.locationId=s.locationId;\"), {\"locationId\"}), {\"location\"}), {\"locationId\"}), {\"location\"})",
                "",
                "in",
                "    Location"
              ]
            }
          }
        ]
      },
      {
        "name": "IsOriginalForecast",
        "columns": [
          {
            "name": "isOriginalForecast",
            "dataType": "boolean",
            "sourceColumn": "isOriginalForecast"
          }
        ],
        "partitions": [
          {
            "name": "IsOriginalForecast",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    IsOriginalForecast = Odbc.Query(Source, \"SELECT TRUE AS isOriginalForecast UNION ALL SELECT FALSE\")",
                "",
                "in",
                "    IsOriginalForecast"
              ]
            }
          }
        ]
      },
      {
        "name": "Measure",
        "columns": [
          {
            "name": "measureId",
            "dataType": "string",
            "sourceColumn": "measureId"
          },
          {
            "name": "measure",
            "dataType": "string",
            "sourceColumn": "measure"
          },
          {
            "name": "perfectScore",
            "dataType": "int64",
            "sourceColumn": "perfectScore"
          }
        ],
        "partitions": [
          {
            "name": "Measure",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Measure = Odbc.Query(Source, \"",
                "SELECT 'ForecastObserved[AvgForecast]' AS measureId,'AvgForecast' AS measure,-1 AS perfectScore UNION ALL",
                "SELECT 'ForecastObserved[AvgObserved]','AvgObserved',-1 UNION ALL",
                "SELECT 'ForecastObserved[BiasOverForecastAvg]','BiasOverForecastAvg',0 UNION ALL",
                "SELECT 'ForecastObserved[BiasOverForecastClassCount]','BiasOverForecastClassCount',0 UNION ALL",
                "SELECT 'ForecastObserved[BiasOverForecastCount]','BiasOverForecastCount',0 UNION ALL",
                "SELECT 'ForecastObserved[BiasOverUnderForecastAvg]','BiasOverUnderForecastAvg',0 UNION ALL",
                "SELECT 'ForecastObserved[BiasPercentClassOver]','BiasPercentClassOver',0 UNION ALL",
                "SELECT 'ForecastObserved[BiasPercentClassUnder]','BiasPercentClassUnder',0 UNION ALL",
                "SELECT 'ForecastObserved[BiasPercentOver]','BiasPercentOver',0 UNION ALL",
                "SELECT 'ForecastObserved[BiasPercentOverUnder]','BiasPercentOverUnder',0 UNION ALL",
                "SELECT 'ForecastObserved[BiasPercentUnder]','BiasPercentUnder',0 UNION ALL",
                "SELECT 'ForecastObserved[BiasStdev]','BiasStdev',0 UNION ALL",
                "SELECT 'ForecastObserved[BiasUnderForecastAvg]','BiasUnderForecastAvg',0 UNION ALL",
                "SELECT 'ForecastObserved[BiasUnderForecastClassCount]','BiasUnderForecastClassCount',0 UNION ALL",
                "SELECT 'ForecastObserved[BiasUnderForecastCount]','BiasUnderForecastCount',0 UNION ALL",
                "SELECT 'ForecastObserved[ClassAccuracy]','ClassAccuracy',1 UNION ALL",
                "SELECT 'ForecastObserved[ClassHit]','ClassHit',-1 UNION ALL",
                "SELECT 'ForecastObserved[ClassMiss]','ClassMiss',-1 UNION ALL",
                "SELECT 'ForecastObserved[ConditionNegative]','ConditionNegative',-1 UNION ALL",
                "SELECT 'ForecastObserved[ConditionPositive]','ConditionPositive',-1 UNION ALL",
                "SELECT 'ForecastObserved[Correlation]','Correlation',1 UNION ALL",
                "SELECT 'ForecastObserved[Covariance]','Covariance',-1 UNION ALL",
                "SELECT 'ForecastObserved[EquitableThreatScore]','EquitableThreatScore',1 UNION ALL",
                "SELECT 'ForecastObserved[FalseDiscoveryRate]','FalseDiscoveryRate',-1 UNION ALL",
                "SELECT 'ForecastObserved[FalseNegative]','FalseNegative',-1 UNION ALL",
                "SELECT 'ForecastObserved[FalseNegativeRate]','FalseNegativeRate',-1 UNION ALL",
                "SELECT 'ForecastObserved[FalseOmissionRate]','FalseOmissionRate',-1 UNION ALL",
                "SELECT 'ForecastObserved[FalsePositive]','FalsePositive',-1 UNION ALL",
                "SELECT 'ForecastObserved[FalsePositiveRate]','FalsePositiveRate',0 UNION ALL",
                "SELECT 'ForecastObserved[ForecastStdev]','ForecastStdev',-1 UNION ALL",
                "SELECT 'ForecastObserved[ForecastVariance]','ForecastVariance',-1 UNION ALL",
                "SELECT 'ForecastObserved[FrequencyBias]','FrequencyBias',1 UNION ALL",
                "SELECT 'ForecastObserved[HanssenAndKuipersDiscriminant]','HanssenAndKuipersDiscriminant',1 UNION ALL",
                "SELECT 'ForecastObserved[HeidkeSkillScore]','HeidkeSkillScore',1 UNION ALL",
                "SELECT 'ForecastObserved[MeanAbsoluteError]','MeanAbsoluteError',0 UNION ALL",
                "SELECT 'ForecastObserved[MeanError]','MeanError',0 UNION ALL",
                "SELECT 'ForecastObserved[MeanSquaredError]','MeanSquaredError',0 UNION ALL",
                "SELECT 'ForecastObserved[MultiClassAccuracy]','MultiClassAccuracy',1 UNION ALL",
                "SELECT 'ForecastObserved[MultiClassHanssenAndKuipersDiscriminant]','MultiClassHanssenAndKuipersDiscriminant',1 UNION ALL",
                "SELECT 'ForecastObserved[MultiClassHeidkeSkillScore]','MultiClassHeidkeSkillScore',1 UNION ALL",
                "SELECT 'ForecastObserved[MultiplicativeBias]','MultiplicativeBias',1 UNION ALL",
                "SELECT 'ForecastObserved[NegativePredictiveValue]','NegativePredictiveValue',-1 UNION ALL",
                "SELECT 'ForecastObserved[NoBiasForecastCount]','NoBiasForecastCount',-1 UNION ALL",
                "SELECT 'ForecastObserved[NoBiasPercent]','NoBiasPercent',1 UNION ALL",
                "SELECT 'ForecastObserved[ObservedStdev]','ObservedStdev',-1 UNION ALL",
                "SELECT 'ForecastObserved[ObservedVariance]','ObservedVariance',-1 UNION ALL",
                "SELECT 'ForecastObserved[OddsRatio]','OddsRatio',-1 UNION ALL",
                "SELECT 'ForecastObserved[OddsRatioSkillScore]','OddsRatioSkillScore',1 UNION ALL",
                "SELECT 'ForecastObserved[OverallAccuracy]','OverallAccuracy',1 UNION ALL",
                "SELECT 'ForecastObserved[Population]','Population',-1 UNION ALL",
                "SELECT 'ForecastObserved[Precision - Positive Predictive Value]','Precision - Positive Predictive Value',1 UNION ALL",
                "SELECT 'ForecastObserved[PredictedConditionNegative]','PredictedConditionNegative',-1 UNION ALL",
                "SELECT 'ForecastObserved[PredictedConditionPositive]','PredictedConditionPositive',-1 UNION ALL",
                "SELECT 'ForecastObserved[Prevalence]','Prevalence',-1 UNION ALL",
                "SELECT 'ForecastObserved[Recall - Probability of Detection]','Recall - Probability of Detection',1 UNION ALL",
                "SELECT 'ForecastObserved[RootMeanSquaredError]','RootMeanSquaredError',0 UNION ALL",
                "SELECT 'ForecastObserved[SkillScoreMeanAbsoluteError]','SkillScoreMeanAbsoluteError',1 UNION ALL",
                "SELECT 'ForecastObserved[SkillScoreMeanSquaredError]','SkillScoreMeanSquaredError',1 UNION ALL",
                "SELECT 'ForecastObserved[SkillScoreRootMeanSquaredError]','SkillScoreRootMeanSquaredError',1 UNION ALL",
                "SELECT 'ForecastObserved[ThreatScore]','ThreatScore',1 UNION ALL",
                "SELECT 'ForecastObserved[TrueNegative]','TrueNegative',-1 UNION ALL",
                "SELECT 'ForecastObserved[TrueNegativeRate]','TrueNegativeRate',-1 UNION ALL",
                "SELECT 'ForecastObserved[TruePositive]','TruePositive',-1 UNION ALL",
                "SELECT 'ForecastObserved[ZeroSkillScoreMeanAbsoluteError]','ZeroSkillScoreMeanAbsoluteError',1 UNION ALL",
                "SELECT 'ForecastObserved[ZeroSkillScoreMeanSquaredError]','ZeroSkillScoreMeanSquaredError',1 UNION ALL",
                "SELECT 'ForecastObserved[ZeroSkillScoreRootMeanSquaredError]','ZeroSkillScoreRootMeanSquaredError',1\")",
                "",
                "in",
                "    Measure"
              ]
            }
          }
        ]
      },
      {
        "name": "LeadTime",
        "columns": [
          {
            "name": "day",
            "dataType": "double",
            "sourceColumn": "day"
          },
          {
            "name": "hour",
            "dataType": "double",
            "sourceColumn": "hour"
          },
          {
            "name": "minute",
            "dataType": "int64",
            "sourceColumn": "minute"
          },
          {
            "name": "hmm",
            "dataType": "string",
            "sourceColumn": "hmm"
          },
          {
            "name": "dHHmm",
            "dataType": "string",
            "sourceColumn": "dHHmm"
          },
          {
            "name": "hm",
            "dataType": "string",
            "sourceColumn": "hm"
          },
          {
            "name": "dHHm",
            "dataType": "string",
            "sourceColumn": "dHHm"
          },
          {
            "name": "dHHmx",
            "dataType": "string",
            "sourceColumn": "dHHmx"
          }
        ],
        "partitions": [
          {
            "name": "LeadTime",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    LeadTime = Table.Sort(Table.Distinct(Odbc.Query(Source, \"",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_LeadTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_LeadTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_LeadTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_LeadTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_LeadTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_LeadTime_Default` UNION ALL",
                "        SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_LeadTime_Default`;\")), {\"minute\"}),",
                "",
                "    LeadTimeH = Table.AddColumn(LeadTime, \"hmm\", each Number.ToText([minute]/60, \"0\") & \":\" & Number.ToText(Number.Mod([minute], 60), \"00\")),",
                "    LeadTimeHD = Table.AddColumn(LeadTimeH, \"dHHmm\", each Number.ToText([minute]/60/24, \"0\") & \".\" & Number.ToText(Number.Mod([minute], 60*24)/60, \"00\") & \":\" & Number.ToText(Number.Mod([minute], 60), \"00\")),",
                "    LeadTimeHDh = Table.AddColumn(LeadTimeHD, \"hm\", each Text.Replace([hmm], \":00\", \"\")),",
                "    LeadTimeHDhd = Table.AddColumn(LeadTimeHDh, \"dHHm\", each Text.Replace([dHHmm], \":00\", \"\")),",
                "    LeadTimeHDhdx = Table.AddColumn(LeadTimeHDhd, \"dHHmx\", each Text.Replace([dHHm], \".\", \"d\") & \"h\")",
                "",
                "in",
                "    LeadTimeHDhdx"
              ]
            }
          }
        ]
      },
      {
        "name": "ForecastObserved",
        "columns": [
          {
            "name": "ensemble",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "ensemble"
          },
          {
            "name": "ensembleMember",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "ensembleMember"
          },
          {
            "name": "eventDate",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "eventDate"
          },
          {
            "name": "eventMinute",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "eventMinute"
          },
          {
            "name": "eventTime",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "eventTime"
          },
          {
            "name": "forecast",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "forecast"
          },
          {
            "name": "forecastClass",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "forecastClass"
          },
          {
            "name": "forecastDate",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "forecastDate"
          },
          {
            "name": "forecastMinute",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "forecastMinute"
          },
          {
            "name": "forecastName",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "forecastName"
          },
          {
            "name": "forecastTime",
            "dataType": "dateTime",
            "isHidden": true,
            "sourceColumn": "forecastTime"
          },
          {
            "name": "isOriginalForecast",
            "dataType": "boolean",
            "isHidden": true,
            "sourceColumn": "isOriginalForecast"
          },
          {
            "name": "leadTime",
            "dataType": "int64",
            "isHidden": true,
            "sourceColumn": "leadTime"
          },
          {
            "name": "location",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "location"
          },
          {
            "name": "observed",
            "dataType": "double",
            "isHidden": true,
            "sourceColumn": "observed"
          },
          {
            "name": "observedClass",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "observedClass"
          },
          {
            "name": "forecastId",
            "dataType": "string",
            "isHidden": true,
            "sourceColumn": "forecastId"
          }
        ],
        "partitions": [
          {
            "name": "2000-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2000-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2000-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2000-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2000-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2000-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2000-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2000-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2000-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2000-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2000-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2000-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2000-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2000-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2000-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2000-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2000-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2000-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2000-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2000-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2000-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2000-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2000-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2000-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2001-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2001-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2001-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2001-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2001-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2001-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2001-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2001-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2001-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2001-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2001-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2001-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2001-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2001-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2001-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2001-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2001-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2001-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2001-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2001-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2001-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2001-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2001-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2001-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2002-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2002-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2002-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2002-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2002-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2002-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2002-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2002-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2002-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2002-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2002-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2002-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2002-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2002-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2002-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2002-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2002-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2002-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2002-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2002-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2002-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2002-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2002-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2002-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2003-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2003-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2003-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2003-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2003-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2003-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2003-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2003-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2003-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2003-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2003-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2003-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2003-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2003-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2003-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2003-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2003-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2003-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2003-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2003-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2003-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2003-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2003-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2003-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2004-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2004-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2004-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2004-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2004-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2004-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2004-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2004-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2004-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2004-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2004-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2004-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2004-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2004-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2004-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2004-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2004-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2004-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2004-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2004-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2004-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2004-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2004-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2004-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2005-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2005-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2005-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2005-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2005-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2005-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2005-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2005-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2005-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2005-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2005-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2005-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2005-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2005-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2005-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2005-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2005-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2005-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2005-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2005-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2005-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2005-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2005-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2005-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2006-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2006-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2006-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2006-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2006-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2006-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2006-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2006-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2006-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2006-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2006-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2006-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2006-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2006-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2006-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2006-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2006-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2006-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2006-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2006-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2006-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2006-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2006-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2006-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2007-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2007-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2007-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2007-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2007-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2007-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2007-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2007-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2007-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2007-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2007-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2007-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2007-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2007-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2007-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2007-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2007-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2007-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2007-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2007-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2007-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2007-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2007-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2007-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2008-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2008-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2008-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2008-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2008-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2008-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2008-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2008-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2008-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2008-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2008-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2008-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2008-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2008-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2008-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2008-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2008-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2008-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2008-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2008-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2008-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2008-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2008-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2008-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2009-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2009-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2009-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2009-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2009-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2009-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2009-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2009-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2009-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2009-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2009-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2009-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2009-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2009-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2009-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2009-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2009-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2009-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2009-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2009-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2009-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2009-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2009-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2009-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2010-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2010-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2010-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2010-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2010-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2010-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2010-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2010-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2010-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2010-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2010-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2010-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2010-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2010-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2010-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2010-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2010-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2010-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2010-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2010-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2010-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2010-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2010-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2010-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2011-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2011-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2011-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2011-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2011-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2011-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2011-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2011-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2011-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2011-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2011-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2011-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2011-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2011-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2011-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2011-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2011-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2011-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2011-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2011-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2011-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2011-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2011-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2011-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2012-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2012-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2012-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2012-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2012-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2012-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2012-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2012-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2012-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2012-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2012-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2012-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2012-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2012-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2012-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2012-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2012-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2012-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2012-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2012-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2012-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2012-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2012-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2012-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2013-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2013-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2013-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2013-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2013-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2013-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2013-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2013-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2013-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2013-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2013-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2013-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2013-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2013-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2013-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2013-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2013-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2013-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2013-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2013-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2013-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2013-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2013-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2013-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2014-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2014-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2014-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2014-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2014-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2014-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2014-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2014-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2014-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2014-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2014-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2014-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2014-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2014-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2014-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2014-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2014-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2014-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2014-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2014-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2014-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2014-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2014-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2014-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2015-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2015-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2015-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2015-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2015-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2015-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2015-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2015-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2015-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2015-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2015-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2015-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2015-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2015-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2015-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2015-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2015-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2015-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2015-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2015-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2015-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2015-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2015-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2015-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2016-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2016-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2016-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2016-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2016-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2016-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2016-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2016-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2016-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2016-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2016-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2016-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2016-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2016-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2016-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2016-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2016-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2016-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2016-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2016-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2016-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2016-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2016-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2016-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2017-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2017-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2017-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2017-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2017-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2017-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2017-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2017-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2017-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2017-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2017-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2017-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2017-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2017-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2017-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2017-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2017-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2017-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2017-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2017-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2017-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2017-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2017-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2017-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2018-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2018-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2018-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2018-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2018-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2018-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2018-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2018-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2018-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2018-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2018-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2018-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2018-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2018-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2018-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2018-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2018-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2018-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2018-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2018-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2018-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2018-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2018-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2018-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2019-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2019-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2019-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2019-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2019-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2019-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2019-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2019-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2019-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2019-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2019-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2019-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2019-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2019-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2019-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2019-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2019-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2019-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2019-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2019-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2019-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2019-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2019-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2019-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2020-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2020-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2020-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2020-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2020-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2020-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2020-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2020-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2020-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2020-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2020-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2020-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2020-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2020-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2020-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2020-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2020-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2020-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2020-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2020-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2020-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2020-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2020-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2020-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2021-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2021-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2021-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2021-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2021-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2021-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2021-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2021-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2021-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2021-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2021-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2021-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2021-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2021-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2021-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2021-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2021-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2021-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2021-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2021-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2021-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2021-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2021-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2021-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2022-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2022-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2022-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2022-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2022-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2022-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2022-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2022-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2022-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2022-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2022-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2022-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2022-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2022-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2022-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2022-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2022-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2022-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2022-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2022-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2022-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2022-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2022-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2022-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2023-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2023-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2023-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2023-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2023-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2023-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2023-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2023-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2023-05",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2023-05\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2023-06",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2023-06\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2023-07",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2023-07\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2023-08",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2023-08\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2023-09",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2023-09\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2023-10",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2023-10\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2023-11",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2023-11\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2023-12",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2023-12\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2024-01",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2024-01\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2024-02",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2024-02\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2024-03",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2024-03\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          },
          {
            "name": "2024-04",
            "source": {
              "type": "m",
              "expression": [
                "let",
                "    Source = \"driver={MongoDB ODBC 1.4.5 ANSI Driver};server=knxpwmongodb1.main.tva.gov;port=3309\",",
                "",
                "    Month = \"2024-04\",",
                "    StartDate = Month & \"-01\",",
                "    EndDate = Date.ToText(Date.AddMonths(Date.FromText(StartDate), 1), \"yyyy-MM-dd\"),",
                "",
                "    Forecasts = Table.Combine({",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RawPreschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_RAS_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Preschedule_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Ocoee_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_NonPower_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Duke_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\"),",
                "        Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Brookfield_Default` WHERE filterForecastTime >= '\" & StartDate & \"' AND filterForecastTime < '\" & EndDate & \"';\")",
                "    }),",
                "    ForecastsSorted = Table.Sort(Forecasts, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\", {\"filterForecastTime\", Order.Descending}, {\"dispatchTime\", Order.Descending}}),",
                "    ForecastsDistinct = Table.Distinct(ForecastsSorted, {\"forecastName\", \"location\", \"ensemble\", \"ensembleMember\", \"forecastTime\", \"eventTime\"}),",
                "    ForecastsFinal = Table.RemoveColumns(ForecastsDistinct, {\"filterForecastTime\", \"dispatchTime\"}),",
                "",
                "    Locations = \"'\" & Text.Combine(List.Distinct(Table.Column(Forecasts, \"location\")), \"','\") & \"'\",",
                "",
                "    ForecastTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"forecastTime\"))),",
                "    ForecastTimeStart = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeEnd = if List.IsEmpty(ForecastTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(ForecastTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    ForecastTimeHours = if List.IsEmpty(ForecastTimeValues) then \"-9999\" else Text.Combine(List.Distinct(List.Transform(ForecastTimeValues, each Number.ToText(Time.Hour(_)))), \",\"),",
                "",
                "    EventTimeValues = List.Sort(List.Distinct(Table.Column(Forecasts, \"eventTime\"))),",
                "    EventTimeStart = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Min(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "    EventTimeEnd = if List.IsEmpty(EventTimeValues) then \"1900-01-01\" else DateTime.ToText(List.Max(EventTimeValues), \"yyyy-MM-ddTHH:mm:ss\"),",
                "",
                "    Normal = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Normal_Default` WHERE location IN (\" & Locations & \") AND HOUR(forecastTime) IN (\" & ForecastTimeHours & \") AND endTime >= '\" & ForecastTimeStart & \"' AND startTime < '\" & ForecastTimeEnd & \"' AND forecastTime >= '\" & ForecastTimeStart & \"' AND forecastTime < '\" & ForecastTimeEnd & \"';\"),",
                "    NormalSorted = Table.Sort(Normal, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    ForecastsFilter = Table.Distinct(Table.SelectColumns(Forecasts, {\"location\", \"forecastTime\", \"eventTime\"})),",
                "    ForecastsFilterSorted = Table.Sort(ForecastsFilter, {\"location\", \"forecastTime\", \"eventTime\"}),",
                "",
                "    NormalFiltered = Table.Join(NormalSorted, {\"location\", \"forecastTime\", \"eventTime\"}, ForecastsFilterSorted, {\"location\", \"forecastTime\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge),",
                "    NormalFinal = Table.RemoveColumns(NormalFiltered, {\"startTime\", \"endTime\"}),",
                "",
                "    ForecastsCombined = Table.Combine({ForecastsFinal, NormalFinal}),",
                "    ForecastsCombinedSorted = Table.Sort(ForecastsCombined, {\"location\", \"eventTime\"}),",
                "",
                "    Observed = Odbc.Query(Source, \"",
                "SELECT * FROM FEWS_ARCHIVE.`QT_Hourly_Observed_Default` WHERE location IN (\" & Locations & \") AND endTime >= '\" & EventTimeStart & \"' AND startTime < '\" & EventTimeEnd & \"' AND eventTime >= '\" & EventTimeStart & \"' AND eventTime < '\" & EventTimeEnd & \"';\"),",
                "    ObservedFinal = Table.RemoveColumns(Observed, {\"startTime\", \"endTime\"}),",
                "    ObservedFinalSorted = Table.Sort(ObservedFinal, {\"location\", \"eventTime\"}),",
                "",
                "    ForecastObserved = Table.Join(ForecastsCombinedSorted, {\"location\", \"eventTime\"}, ObservedFinalSorted, {\"location\", \"eventTime\"}, JoinKind.Inner, JoinAlgorithm.SortMerge)",
                "",
                "in",
                "    ForecastObserved"
              ]
            }
          }
        ],
        "measures": [
          {
            "name": "MeanAbsoluteError",
            "description": "SUM(|Forecast-Observed|)/Population. What is the average magnitude of the forecast errors?  Range: 0 to \u02c6. Perfect score: 0. Does not indicate the direction of the deviations.",
            "expression": "SUMX(ForecastObserved,ABS([forecast]-[observed]))/[Population]"
          },
          {
            "name": "Population",
            "description": "{Forecast,Observation} Pair Instance Count",
            "expression": "COUNTROWS(ForecastObserved)"
          },
          {
            "name": "MeanSquaredError",
            "description": "SUM((Forecast-Observed)^2)/Population",
            "expression": "SUMX(ForecastObserved,POWER([forecast]-[observed],2))/[Population]"
          },
          {
            "name": "RootMeanSquaredError",
            "description": "SQRT(MeanSquaredError). What is the average magnitude of the forecast errors?  Range: 0 to \u02c6. Perfect score: 0. Measures \"average\" error, weighted according to the square of the error. Does not indicate the direction of the deviations. The RMSE puts greater influence on large errors than smaller errors, which may be a good things if large errors are especially undesirable, but may also encourage conservative forecasting.",
            "expression": "SQRT([MeanSquaredError])"
          },
          {
            "name": "MultiplicativeBias",
            "description": "AVG(Forecast)/AVG(Observed). How does the average forecast magnitude compare to the average observed magnitude?  Range: -\u02c6 to \u02c6. Perfect score: 1. Best suited for quantities that have 0 as a lower or upper bound. Does not measure the magnitude of the errors. Does not measure the correspondence between forecasts and observations, i.e., it is possible to get a perfect score for a bad forecast if there are compensating errors.",
            "expression": "AVERAGE(ForecastObserved[forecast])/AVERAGE(ForecastObserved[observed])"
          },
          {
            "name": "Covariance",
            "description": "SUMX(ForecastObserved,([forecast]-AVERAGE([forecast]))*([observed]-AVERAGE([observed])))/[Population]. The average value of the product of the deviations of forecast-observed from their respective means. Used In Correlation. Included For Formula Validation",
            "expression": "SUMX(ForecastObserved,([forecast]-AVERAGE([forecast]))*([observed]-AVERAGE([observed])))/[Population]"
          },
          {
            "name": "ForecastVariance",
            "description": "SUMX(ForecastObserved, POWER([forecast]-AVERAGE([forecast]),2))/[Population] Used In Correlation. Included For Formula Validation. ",
            "expression": "VAR.S(ForecastObserved[forecast])/*SUMX(ForecastObserved, POWER([forecast]-AVERAGE([forecast]),2))/[Population]*/"
          },
          {
            "name": "ObservedVariance",
            "description": "SUMX(ForecastObserved, POWER([observed]-AVERAGE([observed]),2))/[Population]  Used In Correlation. Included For Formula Validation. ",
            "expression": "VAR.S(ForecastObserved[observed])/*SUMX(ForecastObserved, POWER([observed]-AVERAGE([observed]),2))/[Population]*/"
          },
          {
            "name": "ForecastStdev",
            "description": "STDEV.S(Forecast) Used In Correlation. Included For Formula Validation. ",
            "expression": "STDEV.S(ForecastObserved[forecast])"
          },
          {
            "name": "ObservedStdev",
            "description": "STDEV.S(Observed) Used In Correlation. Included For Formula Validation. ",
            "expression": "STDEV.S(ForecastObserved[observed])"
          },
          {
            "name": "Correlation",
            "description": "[Covariance]/([ForecastStdev]*[ObservedStdev]) How well did the forecast values correspond to the observed values? Range: -1 to 1. Perfect score: 1. Good measure of linear association or phase error. Visually, the correlation measures how close the points of a scatter plot are to a straight line. Does not take forecast bias into account - it is possible for a forecast with large errors to still have a good correlation coefficient with the observations. Sensitive to outliers. Zero shows no correlation.",
            "expression": "[Covariance]/([ForecastStdev]*[ObservedStdev])"
          },
          {
            "name": "ClassHit",
            "description": "RowCount(Filter(ForecastClass=ObservedClass)) Whether The Forecasts Fall Within The Observed Values' Range. The Range Is One Of The Normalized Segments Determined By Rainfall Volume Frequencies Of Occurance",
            "expression": "COUNTROWS(FILTER(ForecastObserved,[ForecastClass]=[ObservedClass]))"
          },
          {
            "name": "ClassMiss",
            "description": "RowCount(Filter(ForecastClass<>ObservedClass)). Same As Class Hit, But The Forecasts Do Not Fall Within The Observed Values' Range",
            "expression": "COUNTROWS(FILTER(ForecastObserved,[ForecastClass]<>[ObservedClass]))"
          },
          {
            "name": "OverallAccuracy",
            "description": "ClassHit/Population",
            "expression": "[ClassHit]/[Population]"
          },
          {
            "name": "TruePositive",
            "description": "Hit. The Number Of Rows Where Both The Forecast And Observed Classes Equal The Selected Class",
            "expression": [
              "COUNTROWS(",
              "\tCALCULATETABLE(ForecastObserved, ObservedClass[class]<>\"undefinedLocation\",ObservedClass[class]<>\"undefinedValue\",ForecastClass[class]<>\"undefinedLocation\",ForecastClass[class]<>\"undefinedValue\",",
              "\t\tINTERSECT(ALL(ForecastObserved[forecastClass]),VALUES(ContingencyMatrixClass[class])),",
              "\t\tINTERSECT(ALL(ForecastObserved[observedClass]),VALUES(ContingencyMatrixClass[class])))",
              "\t)/*COUNTROWS(FILTER(ForecastObserved,[ForecastClass]=[SelectedClass] && [ObservedClass]=[SelectedClass]))*/"
            ]
          },
          {
            "name": "SelectedClass",
            "description": "The Selected Class For The Binary Classification Contingency Matrix",
            "expression": "SELECTEDVALUE(ContingencyMatrixClass[class],\"Normal\")",
            "isHidden": true
          },
          {
            "name": "FalsePositive",
            "description": "False Alarm. The Number Of Rows Where The Forecast Class Equals The Selected Class And The Observed Class Does Not Equal The Selected Class",
            "expression": "[PredictedConditionPositive]-[TruePositive]/*COUNTROWS(FILTER(ForecastObserved,[ForecastClass]=[SelectedClass] && [ObservedClass]<>[SelectedClass]))*/"
          },
          {
            "name": "FalseNegative",
            "description": "Miss. The Number Of Rows Where The Forecast Class Does Not Equal The Selected Class And The Observed Class Equals The Selected Class",
            "expression": "[ConditionPositive]-[TruePositive]/*COUNTROWS(FILTER(ForecastObserved,[ForecastClass]<>[SelectedClass] && [ObservedClass]=[SelectedClass]))*/"
          },
          {
            "name": "ConditionPositive",
            "description": "Row Count Where The Observed Class Equals The Selected Class (TP+FN) Included For Validation And Formula Result Drill In. No Intrinsic Statistical Value In Isolation",
            "expression": [
              "COUNTROWS(",
              "\t\tCALCULATETABLE(ForecastObserved, ObservedClass[class]<>\"undefinedLocation\",ObservedClass[class]<>\"undefinedValue\",ForecastClass[class]<>\"undefinedLocation\",ForecastClass[class]<>\"undefinedValue\",",
              "\t\tINTERSECT(ALL(ForecastObserved[observedClass]),VALUES(ContingencyMatrixClass[class]))",
              "\t)/*COUNTROWS(FILTER(ForecastObserved,[ObservedClass]=[SelectedClass]))*/)"
            ]
          },
          {
            "name": "ConditionNegative",
            "description": "Row Count Where The Observed Class Is Not Equal To The Selected Class (TN+FP) Included For Validation And Formula Result Drill In. No Intrinsic Statistical Value In Isolation",
            "expression": [
              "CALCULATE([Population],ObservedClass[class]<>\"undefinedLocation\",ObservedClass[class]<>\"undefinedValue\",ForecastClass[class]<>\"undefinedLocation\",ForecastClass[class]<>\"undefinedValue\")-[PredictedConditionPositive]",
              "/*COUNTROWS(FILTER(ForecastObserved,[ObservedClass]<>[SelectedClass]))*/"
            ]
          },
          {
            "name": "PredictedConditionPositive",
            "description": "Row Count Where Forecast Class Equals The Selected Class (TP+FP) Included For Validation And Formula Result Drill In. No Intrinsic Statistical Value In Isolation",
            "expression": [
              "COUNTROWS(",
              "\t\tCALCULATETABLE(ForecastObserved,ObservedClass[class]<>\"undefinedLocation\",ObservedClass[class]<>\"undefinedValue\",ForecastClass[class]<>\"undefinedLocation\",ForecastClass[class]<>\"undefinedValue\",",
              "\t\tINTERSECT(ALL(ForecastObserved[forecastClass]),VALUES(ContingencyMatrixClass[class])))",
              "\t)/*COUNTROWS(FILTER(ForecastObserved,[ForecastClass]=[SelectedClass]))*/"
            ]
          },
          {
            "name": "PredictedConditionNegative",
            "description": "Row Count Where Forecast Class Is Not Equal To The Selected Class (FN+TN) Included For Validation And Formula Result Drill In. No Intrinsic Statistical Value In Isolation",
            "expression": [
              "CALCULATE([Population],ObservedClass[class]<>\"undefinedLocation\",ObservedClass[class]<>\"undefinedValue\",ForecastClass[class]<>\"undefinedLocation\",ForecastClass[class]<>\"undefinedValue\")-[ConditionPositive]",
              "/*COUNTROWS(FILTER(ForecastObserved,[ForecastClass]<>[SelectedClass]))*/"
            ]
          },
          {
            "name": "Prevalence",
            "description": "ConditionPositive/ClassPopulation",
            "expression": "[ConditionPositive]/CALCULATE([Population],ObservedClass[class]<>\"undefinedLocation\",ObservedClass[class]<>\"undefinedValue\",ForecastClass[class]<>\"undefinedLocation\",ForecastClass[class]<>\"undefinedValue\")"
          },
          {
            "name": "ClassAccuracy",
            "description": "(TruePositive+TrueNegative)/ClassPopulation - Effectively TP/ClassPopulation Due To TN=0 Because Of Contrived Binary Classes Limiting The Set Of Forecast-Observed Instances. Use Caution - The Majority Class, Usually No-Rain, Heavily Influences The Accuracy. Consider Using Recall - Positive Predictive Rate",
            "expression": "([TruePositive]+[TrueNegative])/CALCULATE([Population],ObservedClass[class]<>\"undefinedLocation\",ObservedClass[class]<>\"undefinedValue\",ForecastClass[class]<>\"undefinedLocation\",ForecastClass[class]<>\"undefinedValue\")"
          },
          {
            "name": "FalseDiscoveryRate",
            "description": "FalsePositive/PredictedConditionPositive. False Alarm Ratio (FAR). What fraction of the predicted \"yes\" events actually did not occur (i.e., were false alarms)?  Sensitive to false alarms, but ignores misses. Very sensitive to the climatological frequency of the event.",
            "expression": "[FalsePositive]/[PredictedConditionPositive]"
          },
          {
            "name": "FalseOmissionRate",
            "description": "FalseNegative/PredictedConditionNegative",
            "expression": "[FalseNegative]/[PredictedConditionNegative]"
          },
          {
            "name": "FalsePositiveRate",
            "description": "FalsePositive/ConditionNegative. Probability Of False Fetection (False Alarm Rate). What fraction of the observed \"no\" events were incorrectly forecast as \"yes\"?",
            "expression": "[FalsePositive]/[ConditionNegative]"
          },
          {
            "name": "FalseNegativeRate",
            "description": "FalseNegative/ConditionPositive",
            "expression": "[FalseNegative]/[ConditionPositive]"
          },
          {
            "name": "TrueNegative",
            "description": "The Number Of Rows Where Neither The Forecast Or Observed Classes Equal The Selected Class",
            "expression": [
              "CALCULATE([Population],ObservedClass[class]<>\"undefinedLocation\",ObservedClass[class]<>\"undefinedValue\",ForecastClass[class]<>\"undefinedLocation\",ForecastClass[class]<>\"undefinedValue\")-([ConditionPositive]+[PredictedConditionPositive]-[TruePositive])",
              "/*COUNTROWS(FILTER(ForecastObserved,[ForecastClass]<>[SelectedClass] && [ObservedClass]<>[SelectedClass]))*/"
            ]
          },
          {
            "name": "NegativePredictiveValue",
            "description": "TrueNegative/PredictedConditionNegative",
            "expression": "[TrueNegative]/[PredictedConditionNegative]"
          },
          {
            "name": "TrueNegativeRate",
            "description": "TrueNegative/ConditionNegative",
            "expression": "[TrueNegative]/[ConditionNegative]"
          },
          {
            "name": "BiasStdev",
            "description": "STDEV(Forecast-Observed). Shows How Consistent the Bias Is. 0 Is Consistently Over, Under, Or Equal In Magnitude. Further From Zero Indicates A Large Spread In The Magnitudes Of Bias Observed",
            "expression": "STDEVX.S(ForecastObserved,[forecast]-[observed])"
          },
          {
            "name": "FrequencyBias",
            "description": "PredictedConditionPositive/ConditionPositive. Range: 0 to \u02c6. Perfect score: 1. How did the forecast frequency of \"yes\" events compare to the observed frequency of \"yes\" events?  Measures the ratio of the frequency of forecast events to the frequency of observed events. Indicates whether the forecast system has a tendency to underforecast (BIAS<1) or overforecast (BIAS>1) events. Does not measure how well the forecast corresponds to the observations, only measures relative frequencies.",
            "expression": "[PredictedConditionPositive]/[ConditionPositive]"
          },
          {
            "name": "ThreatScore",
            "description": "Critical Success Index. TruePositive/([TruePositive+FalseNegative+FalsePositive). How well did the forecast \"yes\" events correspond to the observed \"yes\" events?  Range: 0 to 1, 0 indicates no skill. Perfect score: 1. Measures the fraction of observed and/or forecast events that were correctly predicted. It can be thought of as the accuracy when correct negatives have been removed from consideration, that is, TS is only concerned with forecasts that count. Sensitive to hits, penalizes both misses and false alarms. Does not distinguish source of forecast error. Depends on climatological frequency of events (poorer scores for rarer events) since some hits can occur purely due to random chance.",
            "expression": "[TruePositive]/([TruePositive]+[FalseNegative]+[FalsePositive])"
          },
          {
            "name": "EquitableThreatScore",
            "description": "Gilbert Skill Score. (TruePositive-RandomTruePositive)/(TruePositive+FalseNegative+FalsePositive-RandomTruePositive). How well did the forecast \"yes\" events correspond to the observed \"yes\" events?  Range: 0 to 1, 0 indicates no skill. Perfect score: 1. Measures the fraction of observed and/or forecast events that were correctly predicted. It can be thought of as the accuracy when correct negatives have been removed from consideration, that is, TS is only concerned with forecasts that count. Sensitive to hits, penalizes both misses and false alarms. Does not distinguish source of forecast error. Depends on climatological frequency of events (poorer scores for rarer events) since some hits can occur purely due to random chance.",
            "expression": "([TruePositive]-[RandomTruePositive])/([TruePositive]+[FalseNegative]+[FalsePositive]-[RandomTruePositive])"
          },
          {
            "name": "RandomTruePositive",
            "description": "FLOOR((([TruePositive]+[FalseNegative])*([TruePositive]+[FalsePositive]))/[ClassPopulation],1). Used In EquitableThreatScore.",
            "expression": "FLOOR((([TruePositive]+[FalseNegative])*([TruePositive]+[FalsePositive]))/CALCULATE([Population],ObservedClass[class]<>\"undefinedLocation\",ObservedClass[class]<>\"undefinedValue\",ForecastClass[class]<>\"undefinedLocation\",ForecastClass[class]<>\"undefinedValue\"),1)",
            "isHidden": true
          },
          {
            "name": "HanssenAndKuipersDiscriminant",
            "description": "True Skill Statistic, Peirce's Skill Score. How well did the forecast separate the \"yes\" events from the \"no\" events?  Range: -1 to 1, 0 indicates no skill. Perfect score: 1. Uses all elements in contingency table. Does not depend on climatological event frequency. The expression is identical to HK = POD - POFD, but the Hanssen and Kuipers score can also be interpreted as (accuracy for events) + (accuracy for non-events) - 1. For rare events HK is unduly weighted toward the first term (same as POD), so this score may be more useful for more frequent events.",
            "expression": "([TruePositive]/([TruePositive]+[FalseNegative]))-([FalsePositive]/([FalsePositive]+[TrueNegative]))"
          },
          {
            "name": "HeidkeSkillScore",
            "description": "Cohen's K (HSS). What was the accuracy of the forecast relative to that of random chance?  Range: -1 to 1, 0 indicates no skill. Perfect score: 1. Measures the fraction of correct forecasts after eliminating those forecasts which would be correct due purely to random chance. This is a form of the generalized skill score, where the score in the numerator is the number of correct forecasts, and the reference forecast in this case is random chance. In meteorology, at least, random chance is usually not the best forecast to compare to - it may be better to use climatology (long-term average value) or persistence (forecast = most recent observation, i.e., no change) or some other standard.",
            "expression": "(([TruePositive]+[TrueNegative])-[ExpectedCorrect])/(CALCULATE([Population],ObservedClass[class]<>\"undefinedLocation\",ObservedClass[class]<>\"undefinedValue\",ForecastClass[class]<>\"undefinedLocation\",ForecastClass[class]<>\"undefinedValue\")-[ExpectedCorrect])"
          },
          {
            "name": "ExpectedCorrect",
            "description": "FLOOR((([TruePositive]+[FalseNegative])*([TruePositive]+[FalsePositive])*([TrueNegative]+[FalseNegative])*([TrueNegative]+[FalsePositive]))/[ClassPopulation],1). Used In HeidkeSkillScore",
            "expression": [
              "FLOOR(",
              "    (([TruePositive]+[FalseNegative])*([TruePositive]+[FalsePositive])+",
              "    ([TrueNegative]+[FalseNegative])*([TrueNegative]+[FalsePositive]))/[Population],1)"
            ],
            "isHidden": true
          },
          {
            "name": "OddsRatio",
            "description": "What is the ratio of the odds of a \"yes\" forecast being correct, to the odds of a \"yes\" forecast being wrong?  Odds ratio - Range: 0 to \u02c6, 1 indicates no skill. Perfect score: \u02c6. Log odds ratio - Range: -\u02c6 to \u02c6, 0 indicates no skill. Perfect score: \u02c6. Measures the ratio of the odds of making a hit to the odds of making a false alarm. The logarithm of the odds ratio is often used instead of the original value. Takes prior probabilities into account. Gives better scores for rarer events. Less sensitive to hedging. Do not use if any of the cells in the contingency table are equal to 0. Used widely in medicine but not yet in meteorology.",
            "expression": "([TruePositive]*[TrueNegative])/([FalseNegative]*[FalsePositive])"
          },
          {
            "name": "OddsRatioSkillScore",
            "description": "Yule's Q. What was the improvement of the forecast over random chance?  Range: -1 to 1, 0 indicates no skill. Perfect score: 1. Independent of the marginal totals (i.e., of the threshold chosen to separate \"yes\" and \"no\"), so is difficult to hedge.",
            "expression": "([TruePositive]*[TrueNegative]-[FalseNegative]*[FalsePositive])/([TruePositive]*[TrueNegative]+[FalsePositive]*[FalseNegative])"
          },
          {
            "name": "MultiClassAccuracy",
            "description": "Overall, what fraction of the forecasts were in the correct category?  Range: 0 to 1. Perfect score: 1. Simple, intuitive. Can be misleading since it is heavily influenced by the most common category.",
            "expression": [
              "SUMX(",
              "ADDCOLUMNS(",
              "    SUMMARIZE(",
              "        FILTER(CROSSJOIN(ForecastClass,ObservedClass),ForecastClass[class]=ObservedClass[class]",
              "\t && ObservedClass[class]<>\"undefinedLocation\" && ObservedClass[class]<>\"undefinedValue\" && ForecastClass[class]<>\"undefinedLocation\" && ForecastClass[class]<>\"undefinedValue\"),",
              "\t    ForecastClass[class],ObservedClass[class]),",
              "\"TruePositive\",CALCULATE(COUNTROWS(ForecastObserved))),[TruePositive])/[Population]"
            ]
          },
          {
            "name": "MultiClassHeidkeSkillScore",
            "description": "What was the accuracy of the forecast in predicting the correct category, relative to that of random chance?  Range: -\u02c6 to 1, 0 indicates no skill. Perfect score: 1. Measures the fraction of correct forecasts after eliminating those forecasts which would be correct due purely to random chance. This is one form of a generalized skill score, where the score in the numerator is the number of correct forecasts, and the reference forecast in this case is random chance. Requires a large sample size to make sure that the elements of the contingency table are all adequately sampled. In meteorology, at least, random chance is usually not the best forecast to compare to - it may be better to use climatology (long-term average value) or persistence (forecast is most recent observation, i.e., no change) or some other standard.",
            "expression": "([MultiClassAccuracy]-([MultiClassSumClassProductRatio]))/(1-[MultiClassSumClassProductRatio])"
          },
          {
            "name": "MultiClassSumClassProductRatio",
            "description": "Used In MultiClassHeidkeSkillScore",
            "expression": [
              "SUMX(",
              "ADDCOLUMNS(",
              "    SUMMARIZE(FILTER(CROSSJOIN(ForecastClass,ObservedClass),ForecastClass[class]=ObservedClass[class] && ObservedClass[class]<>\"undefinedLocation\" && ObservedClass[class]<>\"undefinedValue\" && ForecastClass[class]<>\"undefinedLocation\" && ForecastClass[class]<>\"undefinedValue\"),",
              "    ForecastClass[class],ObservedClass[class]),",
              "\"PredicedClass\",CALCULATE(COUNTROWS(ForecastObserved),ALL(ObservedClass)),",
              "\"ObservedClass\",CALCULATE(COUNTROWS(ForecastObserved),ALL(ForecastClass))),[PredicedClass]*[ObservedClass])/POWER(CALCULATE([Population],ObservedClass[class]<>\"undefinedLocation\",ObservedClass[class]<>\"undefinedValue\",ForecastClass[class]<>\"undefinedLocation\",ForecastClass[class]<>\"undefinedValue\"),2)"
            ],
            "isHidden": true
          },
          {
            "name": "MultiClassHanssenAndKuipersDiscriminant",
            "description": "True Skill Statistic, Peirce's Skill Score. What was the accuracy of the forecast in predicting the correct category, relative to that of random chance?  Range: -1 to 1, 0 indicates no skill. Perfect score: 1. Similar to the Heidke skill score, except that in the denominator the fraction of correct forecasts due to random chance is for an unbiased forecast.",
            "expression": "([MultiClassAccuracy]-[MultiClassSumClassProductRatio])/(1-[MultiClassSumObservedRatioSquared])"
          },
          {
            "name": "MultiClassSumObservedRatioSquared",
            "description": "MultiClassHanssenAndKuipersDiscriminant",
            "expression": [
              "SUMX(",
              "ADDCOLUMNS(",
              "    SUMMARIZE(FILTER(CROSSJOIN(ForecastClass,ObservedClass),ForecastClass[class]=ObservedClass[class] && ObservedClass[class]<>\"undefinedLocation\" && ObservedClass[class]<>\"undefinedValue\" && ForecastClass[class]<>\"undefinedLocation\" && ForecastClass[class]<>\"undefinedValue\"),",
              "    ForecastClass[class],ObservedClass[class]),",
              "\"ObservedClass\",CALCULATE(COUNTROWS(ForecastObserved),ALL(ForecastClass))),POWER([ObservedClass],2))/POWER(CALCULATE([Population],ObservedClass[class]<>\"undefinedLocation\",ObservedClass[class]<>\"undefinedValue\",ForecastClass[class]<>\"undefinedLocation\",ForecastClass[class]<>\"undefinedValue\"),2)"
            ],
            "isHidden": true
          },
          {
            "name": "MultiClassGerrityScore",
            "description": "What was the accuracy of the forecast in predicting the correct category, relative to that of random chance?  Range: -1 to 1, 0 indicates no skill. Perfect score: 1. Uses all entries in the contingency table, does not depend on the forecast distribution, and is equitable (i.e., random and constant forecasts score a value of 0). GS does not reward conservative forecasting like HSS and HK, but rather rewards forecasts for correctly predicting the less likely categories. Smaller errors are penalized less than larger forecast errors. This is achieved through the use of the scoring matrix.",
            "expression": "0",
            "isHidden": true
          },
          {
            "name": "ClassPopulation",
            "description": "Not Used",
            "expression": "[ConditionPositive]+[PredictedConditionPositive]-[TruePositive]/*COUNTROWS(FILTER(ForecastObserved,[ObservedClass]=[SelectedClass] || [ForecastClass]=[SelectedClass]))*/",
            "isHidden": true
          },
          {
            "name": "AvgObserved",
            "description": "For Plotting Instances. E.g. Scatter Plot",
            "expression": "AVERAGE(ForecastObserved[observed])"
          },
          {
            "name": "AvgForecast",
            "description": "For Plotting Instances. E.g. Scatter Plot",
            "expression": "AVERAGE(ForecastObserved[forecast])"
          },
          {
            "name": "MeanError",
            "description": "SUM(Forecast-Observed)/Population. What is the average forecast error?  Range: -\u02c6 to \u02c6. Perfect score: 0. Also called the (additive) bias. Does not measure the magnitude of the errors. Does not measure the correspondence between forecasts and observations, i.e., it is possible to get a perfect score for a bad forecast if there are compensating errors.",
            "expression": "SUMX(ForecastObserved,[forecast]-[observed])/[Population]"
          },
          {
            "name": "SkillScoreMeanError",
            "description": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-(MeanError/[MeanError]Normal). ",
            "expression": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-([MeanError]/CALCULATE([MeanError],Forecast[forecast]=\"Normal\",ALL(Forecast))))",
            "isHidden": true
          },
          {
            "name": "SkillScoreMeanAbsoluteError",
            "description": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-(MeanAbsoluteError/[MeanAbsoluteError]Normal). Range: -\u02c6 to 1. Perfect score: 1. Zero Is Random Chance / No Skill",
            "expression": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-([MeanAbsoluteError]/CALCULATE([MeanAbsoluteError],Forecast[forecast]=\"Normal\",ALL(Forecast))))"
          },
          {
            "name": "SkillScoreRootMeanSquaredError",
            "description": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-(RootMeanSquaredError/[RootMeanSquaredError]Normal). Range: -\u02c6 to 1. Perfect score: 1. Zero Is Random Chance / No Skill",
            "expression": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-([RootMeanSquaredError]/CALCULATE([RootMeanSquaredError],Forecast[forecast]=\"Normal\",ALL(Forecast))))"
          },
          {
            "name": "SkillScoreMeanSquaredError",
            "description": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-(MeanSquaredError/[MeanSquaredError]Normal). Range: -\u02c6 to 1. Perfect score: 1. Zero Is Random Chance / No Skill",
            "expression": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-([MeanSquaredError]/CALCULATE([MeanSquaredError],Forecast[forecast]=\"Normal\",ALL(Forecast))))"
          },
          {
            "name": "ZeroSkillScoreMeanError",
            "description": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-(MeanError/[MeanError]Zero). ",
            "expression": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-([MeanError]/CALCULATE(-SUM(ForecastObserved[observed])/[Population],Forecast[forecast]=\"Normal\",ALL(Forecast))))",
            "isHidden": true
          },
          {
            "name": "ZeroSkillScoreMeanAbsoluteError",
            "description": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-(MeanAbsoluteError/[MeanAbsoluteError]Zero). Range: -\u02c6 to 1. Perfect score: 1. Zero Is No Rain",
            "expression": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-([MeanAbsoluteError]/CALCULATE(SUM(ForecastObserved[observed])/[Population],Forecast[forecast]=\"Normal\",ALL(Forecast))))"
          },
          {
            "name": "ZeroSkillScoreMeanSquaredError",
            "description": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-(MeanSquaredError/[MeanSquaredError]Zero). Range: -\u02c6 to 1. Perfect score: 1. Zero Is No Rain",
            "expression": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-([MeanSquaredError]/CALCULATE(SUMX(ForecastObserved,POWER([observed],2))/[Population],Forecast[forecast]=\"Normal\",ALL(Forecast))))"
          },
          {
            "name": "ZeroSkillScoreRootMeanSquaredError",
            "description": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-(RootMeanSquaredError/[RootMeanSquaredError]Zero). Range: -\u02c6 to 1. Perfect score: 1. Zero Is No Rain",
            "expression": "IF(ISBLANK([MeanAbsoluteError]),BLANK(), 1-([RootMeanSquaredError]/SQRT(CALCULATE(SUMX(ForecastObserved,POWER([observed],2))/[Population],Forecast[forecast]=\"Normal\",ALL(Forecast)))))"
          },
          {
            "name": "BiasOverForecastCount",
            "description": "RowCount(Filter(Forecast-Observed>0)). Rather Than Magnitude Like BiasOverForecastAvg, The Equally Weighted Count Of Overforecast Instances. Can Be Used Subsequently To Calculate The Distribution Of Over, Under and Equal Forecast Instances Relative To The Total",
            "expression": "COUNTROWS(FILTER(ForecastObserved,[forecast]-[observed]>0))"
          },
          {
            "name": "BiasUnderForecastCount",
            "description": "RowCount(Filter(Forecast-Observed<0)). Rather Than Magnitude Like Bias UnderForecastAvg, The Equally Weighted Count Of Underforecast Instances. Can Be Used Subsequently To Calculate The Distribution Of Over, Under and Equal Forecast Instances Relative To The Total",
            "expression": "COUNTROWS(FILTER(ForecastObserved,[forecast]-[observed]<0))"
          },
          {
            "name": "NoBiasForecastCount",
            "description": "RowCount(Filter(Forecast-Observed=0)). Can Be Used Subsequently To Calculate The Distribution Of Over, Under and Equal Forecast Instances Relative To The Total",
            "expression": "COUNTROWS(FILTER(ForecastObserved,[forecast]-[observed]=0))"
          },
          {
            "name": "BiasOverForecastAvg",
            "description": "SUM(Filter(Forecast-Observed>0),Forecast-Observed)/BiasOverForecastCount. The Average Magnitude When The Forecast Overpredicts. Added Because Mean Error Alone Can Mask Deviance When Equally Over/Under Biased Instances Exist.",
            "expression": "SUMX(FILTER(ForecastObserved,[forecast]-[observed]>0),[forecast]-[observed])/[BiasOverForecastCount]"
          },
          {
            "name": "BiasUnderForecastAvg",
            "description": "SUM(Filter(Forecast-Observed<0),Observed-Forecast)/BiasUnderForecastCount (Normalized To A Positive Average Magnitude For Camparison To BiasOverForecastAverage). The Average Magnitude When The Forecast Underpredicts. Added Because Mean Error Alone Can Mask Deviance When Equally Over/Under Biased Instances Exist.",
            "expression": "SUMX(FILTER(ForecastObserved,[forecast]-[observed]<0),[observed]-[forecast])/[BiasUnderForecastCount]"
          },
          {
            "name": "BiasPercentOver",
            "description": "BiasOverForecastCount/Population. The Percent Of Overforecast Instances Relative To The Total",
            "expression": "[BiasOverForecastCount]/[Population]"
          },
          {
            "name": "BiasPercentUnder",
            "description": "BiasUnderForecastCount/Population. The Percent Of Underforecast Instances Relative To The Total",
            "expression": "[BiasUnderForecastCount]/[Population]"
          },
          {
            "name": "NoBiasPercent",
            "description": "NoBiasForecastCount/Population. The Percent Of Perfect Instances Relative To The Total",
            "expression": "[NoBiasForecastCount]/[Population]"
          },
          {
            "name": "BiasPercentOverUnder",
            "description": "(BiasOverForecastCount-BiasUnderForecastCount)/(BiasUnderForecastCount+BiasOverForecastCount). Positive Values Indicate More Instances Overforecasting, Nagative Vaues Indicate Underforecasting.Can Mask Deviance When Equally Over/Under Biased Instances Exist. FocusedOnly On The In-Error Instances. Range: -1 To 1 Where 0 Is Equally Over And Under Biased, Positive Is Biased Over, And Negative Is Biased Under ",
            "expression": "([BiasOverForecastCount]-[BiasUnderForecastCount])/([BiasOverForecastCount]+[BiasUnderForecastCount])"
          },
          {
            "name": "BiasOverUnderForecastAvg",
            "description": "SUM(FILTER(forecast-Observed<>0),forecast-Observed)/(BiasUnderForecastCount+BiasOverForecastCount). Differs From MeanError In That It Excludes Instances Where forecast=Observed, Focusing Only On The In-Error Instances. Can Mask Deviance When Equally Over/Under Biased Instances Exist.",
            "expression": "SUMX(FILTER(ForecastObserved,[forecast]-[observed]<>0),[forecast]-[observed])/([BiasUnderForecastCount]+[BiasOverForecastCount])"
          },
          {
            "name": "BiasOverForecastClassCount",
            "description": "Rather Than Magnitude Like BiasOverForecastAvg, The Equally Weighted Count Of Overforecast Out Of Class Instances. Can Be Used Subsequently To Calculate The Distribution Of Over, Under and Equal forecast Instances Relative To The Total",
            "expression": "COUNTROWS(FILTER(ForecastObserved,[forecastClass]<>\"undefinedLocation\" && [forecastClass]<>\"undefinedValue\" && RELATED(ForecastClass[class])>RELATED(ObservedClass[class])))"
          },
          {
            "name": "BiasUnderForecastClassCount",
            "description": "Rather Than Magnitude Like Bias UnderForecastAvg, The Equally Weighted Count Of Underforecast Out Of Class Instances. Can Be Used Subsequently To Calculate The Distribution Of Over, Under and Equal forecast Instances Relative To The Total",
            "expression": "COUNTROWS(FILTER(ForecastObserved,[forecastClass]<>\"undefinedLocation\" && [forecastClass]<>\"undefinedValue\" && RELATED(ForecastClass[class])<RELATED(ObservedClass[class])))"
          },
          {
            "name": "BiasPercentClassOver",
            "description": "BiasOverForecastClassCount/Population. The Percent Of Overforecast Out Of Class Instances Relative To The Total",
            "expression": "[BiasOverForecastClassCount]/[Population]"
          },
          {
            "name": "BiasPercentClassUnder",
            "description": "BiasUnderForecastClassCount/Population. The Percent Of Underforecast Out Of Class Instances Relative To The Total",
            "expression": "[BiasUnderForecastClassCount]/[Population]"
          },
          {
            "name": "Precision",
            "description": "[Positive Predictive Value]. How Well the Forecast Predicted The Selected Class. Increased False Positives Diminish This Score - TruePositive/PredictedConditionPositive = TP/(TP+FP). A Low Ratio Indicates A Poor Predictor Due To Heavy False Positives. Success Ratio (SR). What fraction of the forecast \"yes\" events were correctly observed?  Gives information about the likelihood of an observed event, given that it was forecast. It is sensitive to false alarms but ignores misses.",
            "expression": "[TruePositive]/[PredictedConditionPositive]"
          },
          {
            "name": "Recall",
            "description": "[Probability of Detection]. Hit Rate. How Well The Forecast Captures Events Regardless Of False Positives. Increased Flase Negatives Diminish This Score - TruePositive/ConditionPositive = TP/(TP+FN). A Low Score Indicates A Poor Predictor Due To Its Inability To Capture A Majority Of Predictid Cases. What fraction of the observed \"yes\" events were correctly forecast? Range: 0 to 1. Perfect score: 1. Sensitive to hits, but ignores false alarms. Very sensitive to the climatological frequency of the event. Good for rare events.Can be artificially improved by issuing more \"yes\" forecasts to increase the number of hits.",
            "expression": "[TruePositive]/[ConditionPositive]"
          },
          {
            "name": "MedianAbsoluteError",
            "description": "MEDIANX(ForecastObserved,ABS([forecast]-[observed])). The middle value of the set of the absolute values of [forecast]-[observed]",
            "expression": "MEDIANX(ForecastObserved,ABS([forecast]-[observed]))"
          },
          {
            "name": "MedianError",
            "description": "MEDIANX(ForecastObserved,[forecast]-[observed]). The middle value of the set of [forecast]-[observed]",
            "expression": "MEDIANX(ForecastObserved,[forecast]-[observed])"
          },
          {
            "name": "Min",
            "description": "MINX(ForecastObserved,[forecast]-[observed]). The minimum [forecast]-[observed].",
            "expression": "MINX(ForecastObserved,[forecast]-[observed])"
          },
          {
            "name": "Max",
            "description": "MAXX(ForecastObserved,[forecast]-[observed]). The maximum [forecast]-[observed].",
            "expression": "MAXX(ForecastObserved,[forecast]-[observed])"
          },
          {
            "name": "Percentile05",
            "description": "PERCENTILEX.INC(ForecastObserved,[forecast]-[observed], 0.05). The value at the 5% point in a set.",
            "expression": "PERCENTILEX.INC(ForecastObserved,[forecast]-[observed], 0.05)"
          },
          {
            "name": "Percentile25",
            "description": "PERCENTILEX.INC(ForecastObserved,[forecast]-[observed], 0.25). The value at the 25% point in a set.",
            "expression": "PERCENTILEX.INC(ForecastObserved,[forecast]-[observed], 0.25)"
          },
          {
            "name": "Percentile75",
            "description": "PERCENTILEX.INC(ForecastObserved,[forecast]-[observed], 0.75). The value at the 75% point in a set.",
            "expression": "PERCENTILEX.INC(ForecastObserved,[forecast]-[observed], 0.75)"
          },
          {
            "name": "Percentile95",
            "description": "PERCENTILEX.INC(ForecastObserved,[forecast]-[observed], 0.95). The value at the 95% point in a set.",
            "expression": "PERCENTILEX.INC(ForecastObserved,[forecast]-[observed], 0.95)"
          },
          {
            "name": "Midpoint",
            "description": "[Min]+([Max]-[Min])*0.50. The point halfway between the [Min] and [Max]",
            "expression": "[Min]+([Max]-[Min])*0.50"
          },
          {
            "name": "Point05",
            "description": "[Min]+([Max]-[Min])*0.05. The point 5% between the [Min] and [Max]",
            "expression": "[Min]+([Max]-[Min])*0.05"
          },
          {
            "name": "Point25",
            "description": "[Min]+([Max]-[Min])*0.25. The point 25% between the [Min] and [Max]",
            "expression": "[Min]+([Max]-[Min])*0.25"
          },
          {
            "name": "Point75",
            "description": "[Min]+([Max]-[Min])*0.75. The point 75% between the [Min] and [Max]",
            "expression": "[Min]+([Max]-[Min])*0.75"
          },
          {
            "name": "Point95",
            "description": "[Min]+([Max]-[Min])*0.95. The point 95% between the [Min] and [Max]",
            "expression": "[Min]+([Max]-[Min])*0.95"
          }
        ]
      }
    ],
    "relationships": [
      {
        "name": "ForecastObserved_eventDate_EventDate_date",
        "fromTable": "ForecastObserved",
        "fromColumn": "eventDate",
        "toTable": "EventDate",
        "toColumn": "date"
      },
      {
        "name": "ForecastObserved_forecastDate_ForecastDate_date",
        "fromTable": "ForecastObserved",
        "fromColumn": "forecastDate",
        "toTable": "ForecastDate",
        "toColumn": "date"
      },
      {
        "name": "ForecastObserved_forecastMinute_ForecastTime_minute",
        "fromTable": "ForecastObserved",
        "fromColumn": "forecastMinute",
        "toTable": "ForecastTime",
        "toColumn": "minute"
      },
      {
        "name": "ForecastObserved_location_Location_location",
        "fromTable": "ForecastObserved",
        "fromColumn": "location",
        "toTable": "Location",
        "toColumn": "location"
      },
      {
        "name": "ForecastObserved_eventMinute_LeadTime_minute",
        "fromTable": "ForecastObserved",
        "fromColumn": "eventMinute",
        "toTable": "EventTime",
        "toColumn": "minute"
      },
      {
        "name": "ForecastObserved_leadTime_LeadTime_minute",
        "fromTable": "ForecastObserved",
        "fromColumn": "leadTime",
        "toTable": "LeadTime",
        "toColumn": "minute"
      },
      {
        "name": "ForecastObserved_observedClass_ObservedClass_class",
        "fromTable": "ForecastObserved",
        "fromColumn": "observedClass",
        "toTable": "ObservedClass",
        "toColumn": "class"
      },
      {
        "name": "ForecastObserved_forecastClass_ForecastClass_class",
        "fromTable": "ForecastObserved",
        "fromColumn": "forecastClass",
        "toTable": "ForecastClass",
        "toColumn": "class"
      },
      {
        "name": "ForecastObserved_observedClass_ContingencyMatrixClass_class",
        "fromTable": "ForecastObserved",
        "fromColumn": "observedClass",
        "toTable": "ContingencyMatrixClass",
        "toColumn": "class",
        "isActive": false
      },
      {
        "name": "ForecastObserved_forecastClass_ContingencyMatrixClass_class",
        "fromTable": "ForecastObserved",
        "fromColumn": "forecastClass",
        "toTable": "ContingencyMatrixClass",
        "toColumn": "class",
        "isActive": false
      },
      {
        "name": "ForecastObserved_isOriginalForecast_IsOriginalForecast_isOriginalForecast",
        "fromTable": "ForecastObserved",
        "fromColumn": "isOriginalForecast",
        "toTable": "IsOriginalForecast",
        "toColumn": "isOriginalForecast"
      },
      {
        "name": "ForecastObserved_forecastId_Forecast_forecastId",
        "fromTable": "ForecastObserved",
        "fromColumn": "forecastId",
        "toTable": "Forecast",
        "toColumn": "forecastId"
      }
    ],
    "roles": [
      {
        "name": "Admin",
        "modelPermission": "administrator",
        "members": [
          {
            "memberName": "TVA\\FLD_RW_FEWS_ADMINS"
          }
        ]
      },
      {
        "name": "User",
        "modelPermission": "administrator",
        "members": [
          {
            "memberName": "Everyone"
          }
        ]
      }
    ],
    "annotations": [
      {
        "name": "ClientCompatibilityLevel",
        "value": "700"
      }
    ]
  },
  "id": "Verification_QT_Hourly"
}